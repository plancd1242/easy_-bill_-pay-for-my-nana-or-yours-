<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nana Easy Bill Pay (Practice)</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin: 0; background:#0b0f14; color:#e9eef7; }
    .wrap { max-width: 980px; margin: 0 auto; padding: 22px; }
    h1 { margin: 0 0 6px; font-size: 26px; }
    .sub { margin: 0 0 18px; opacity: .85; }
    .card { background:#121a24; border:1px solid #223044; border-radius: 14px; padding: 16px; margin: 14px 0; }
    .row { display:flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    input, button {
      border-radius: 12px; border:1px solid #2a3a52; background:#0e1620; color:#e9eef7;
      padding: 12px 12px; font-size: 16px;
    }
    input { flex: 1 1 180px; }
    button { cursor: pointer; font-weight: 650; }
    button.primary { background:#1f6feb; border-color:#2b7cff; }
    button.good { background:#238636; border-color:#2ea043; }
    button.warn { background:#b42318; border-color:#ef4444; }
    button:disabled { opacity:.55; cursor:not-allowed; }
    .pill { display:inline-block; padding: 6px 10px; border-radius: 999px; font-size: 13px; border:1px solid #2a3a52; }
    .pill.paid { background: rgba(35,134,54,.2); border-color:#2ea043; }
    .pill.due { background: rgba(31,111,235,.18); border-color:#2b7cff; }
    table { width:100%; border-collapse: collapse; }
    th, td { text-align:left; padding: 10px 8px; border-bottom: 1px solid #223044; vertical-align: middle; }
    th { font-size: 13px; opacity:.85; }
    .small { font-size: 13px; opacity:.9; }
    .muted { opacity:.75; }
    .right { text-align:right; white-space: nowrap; }
    .footer { margin-top: 18px; font-size: 13px; opacity:.75; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#0e1620; border:1px solid #223044; padding: 2px 6px; border-radius: 8px; }

    /* Modal */
    #payModal { display:none; position:fixed; inset:0; background:rgba(0,0,0,.62); padding: 18px; }
    #payModal .box {
      max-width: 560px; margin: 12vh auto; background:#121a24;
      border:1px solid #223044; border-radius:14px; padding: 16px;
    }
    #payModal h2 { margin: 0 0 10px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>üè¶ Nana Easy Bill Pay (Practice)</h1>
    <p class="sub">
      Nana-friendly flow: click <b>Pay</b> ‚Üí confirm pop-up ‚Üí marked as paid.
      <br><span class="muted">(Practice mode: no real money is sent.)</span>
    </p>

    <div class="card">
      <div class="row">
        <input id="name" placeholder="Bill name (ex: Electric)" autocomplete="off" />
        <input id="amount" placeholder="Amount (ex: 74.25)" inputmode="decimal" autocomplete="off" />
        <input id="due" placeholder="Due date (YYYY-MM-DD)" inputmode="numeric" autocomplete="off" />
        <button class="primary" id="addBtn">+ Add Bill</button>
      </div>
      <p class="small muted" style="margin:10px 0 0;">
        Tip: Due date format: <span class="kbd">2026-01-20</span> (or leave blank)
      </p>
    </div>

    <div class="card">
      <div class="row" style="justify-content: space-between;">
        <div class="row">
          <span class="pill due" id="dueCount">Due: 0</span>
          <span class="pill paid" id="paidCount">Paid: 0</span>
        </div>
        <div class="row">
          <button id="clearPaidBtn" class="warn">Clear Paid</button>
          <button id="resetBtn" class="warn">Reset All</button>
        </div>
      </div>

      <div style="overflow:auto; margin-top:10px;">
        <table>
          <thead>
            <tr>
              <th>Bill</th>
              <th>Amount</th>
              <th>Due</th>
              <th>Status</th>
              <th class="right">Actions</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>

      <p class="footer">
        Saves on this device using <span class="kbd">localStorage</span>.
        If you clear browser data, the bills may disappear.
      </p>
    </div>
  </div>

  <!-- Confirm Pay Modal -->
  <div id="payModal">
    <div class="box">
      <h2>Confirm Payment</h2>
      <p id="payText" style="margin:0 0 14px; opacity:.9;"></p>
      <div style="display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap;">
        <button id="cancelPayBtn">Cancel</button>
        <button id="confirmPayBtn" class="good">Confirm Pay</button>
      </div>
      <p style="margin:12px 0 0; font-size:13px; opacity:.75;">
        Practice mode: this only marks the bill paid. (No real money.)
      </p>
    </div>
  </div>

  <script>
    // Nana Easy Bill Pay (Practice) - single-file version

    const LS_KEY = "nana_billpay_v1";

    let bills = loadBills();

    const elName = document.getElementById("name");
    const elAmount = document.getElementById("amount");
    const elDue = document.getElementById("due");
    const elAddBtn = document.getElementById("addBtn");
    const elTbody = document.getElementById("tbody");
    const elDueCount = document.getElementById("dueCount");
    const elPaidCount = document.getElementById("paidCount");
    const elClearPaidBtn = document.getElementById("clearPaidBtn");
    const elResetBtn = document.getElementById("resetBtn");

    // Modal elements
    const payModal = document.getElementById("payModal");
    const payText = document.getElementById("payText");
    const cancelPayBtn = document.getElementById("cancelPayBtn");
    const confirmPayBtn = document.getElementById("confirmPayBtn");
    let pendingPayId = null;

    function uid() {
      return Math.random().toString(16).slice(2) + "-" + Date.now().toString(16);
    }

    function demoBills() {
      return [
        { id: uid(), name: "Electric", amount: 74.25, due: "2026-01-20", paid: false, paidAt: null },
        { id: uid(), name: "Water", amount: 31.10, due: "2026-01-18", paid: true, paidAt: new Date().toISOString() },
      ];
    }

    function loadBills() {
      try {
        const raw = localStorage.getItem(LS_KEY);
        if (!raw) return demoBills();
        const parsed = JSON.parse(raw);
        if (!Array.isArray(parsed)) return demoBills();
        return parsed;
      } catch {
        return demoBills();
      }
    }

    function saveBills() {
      localStorage.setItem(LS_KEY, JSON.stringify(bills));
    }

    function openPayModal(billId) {
      const b = bills.find(x => x.id === billId);
      if (!b) return;
      pendingPayId = billId;
      payText.textContent = `Pay $${Number(b.amount).toFixed(2)} to "${b.name}" now?`;
      payModal.style.display = "block";
    }

    function closePayModal() {
      pendingPayId = null;
      payModal.style.display = "none";
    }

    cancelPayBtn.addEventListener("click", closePayModal);

    // click outside modal box closes it
    payModal.addEventListener("click", (e) => {
      if (e.target === payModal) closePayModal();
    });

    confirmPayBtn.addEventListener("click", () => {
      if (!pendingPayId) return;
      markPaid(pendingPayId);
      closePayModal();
    });

    function markPaid(billId) {
      const b = bills.find(x => x.id === billId);
      if (!b) return;
      b.paid = true;
      b.paidAt = new Date().toISOString();
      saveBills();
      render();
    }

    function markUnpaid(billId) {
      const b = bills.find(x => x.id === billId);
      if (!b) return;
      b.paid = false;
      b.paidAt = null;
      saveBills();
      render();
    }

    function addBillFromInputs() {
      const name = elName.value.trim();
      const amountStr = elAmount.value.trim();
      const due = elDue.value.trim();

      const amount = Number(amountStr);

      if (!name) return alert("Please enter a bill name.");
      if (!Number.isFinite(amount) || amount <= 0) return alert("Please enter a valid amount (like 74.25).");
      if (due && !/^\d{4}-\d{2}-\d{2}$/.test(due)) return alert("Due date must be YYYY-MM-DD (or leave blank).");

      bills.push({
        id: uid(),
        name,
        amount,
        due,
        paid: false,
        paidAt: null
      });

      elName.value = "";
      elAmount.value = "";
      elDue.value = "";

      saveBills();
      render();
    }

    function render() {
      // unpaid first, then soonest due
      const sorted = [...bills].sort((a, b) => {
        if (a.paid !== b.paid) return a.paid ? 1 : -1;
        return (a.due || "9999-99-99").localeCompare(b.due || "9999-99-99");
      });

      elTbody.innerHTML = "";

      let dueCount = 0;
      let paidCount = 0;

      for (const b of sorted) {
        if (b.paid) paidCount++; else dueCount++;

        const tr = document.createElement("tr");

        const tdName = document.createElement("td");
        tdName.textContent = b.name;

        const tdAmt = document.createElement("td");
        tdAmt.textContent = `$${Number(b.amount).toFixed(2)}`;

        const tdDue = document.createElement("td");
        tdDue.textContent = b.due || "‚Äî";

        const tdStatus = document.createElement("td");
        const status = document.createElement("span");
        status.className = "pill " + (b.paid ? "paid" : "due");
        status.textContent = b.paid ? "Paid" : "Due";
        tdStatus.appendChild(status);

        const tdActions = document.createElement("td");
        tdActions.className = "right";

        const payBtn = document.createElement("button");
        payBtn.className = b.paid ? "" : "good";
        payBtn.textContent = b.paid ? "Unpay" : "Pay";

        payBtn.addEventListener("click", () => {
          if (b.paid) markUnpaid(b.id);
          else openPayModal(b.id);
        });

        const delBtn = document.createElement("button");
        delBtn.className = "warn";
        delBtn.style.marginLeft = "8px";
        delBtn.textContent = "Delete";
        delBtn.addEventListener("click", () => {
          const ok = confirm(`Delete "${b.name}"?`);
          if (!ok) return;
          bills = bills.filter(x => x.id !== b.id);
          saveBills();
          render();
        });

        tdActions.appendChild(payBtn);
        tdActions.appendChild(delBtn);

        tr.appendChild(tdName);
        tr.appendChild(tdAmt);
        tr.appendChild(tdDue);
        tr.appendChild(tdStatus);
        tr.appendChild(tdActions);

        elTbody.appendChild(tr);
      }

      elDueCount.textContent = `Due: ${dueCount}`;
      elPaidCount.textContent = `Paid: ${paidCount}`;
    }

    // Events
    elAddBtn.addEventListener("click", addBillFromInputs);

    // Press Enter to add quickly
    [elName, elAmount, elDue].forEach(el => {
      el.addEventListener("keydown", (e) => {
        if (e.key === "Enter") addBillFromInputs();
      });
    });

    elClearPaidBtn.addEventListener("click", () => {
      const ok = confirm("Clear (remove) all PAID bills?");
      if (!ok) return;
      bills = bills.filter(b => !b.paid);
      saveBills();
      render();
    });

    elResetBtn.addEventListener("click", () => {
      const ok = confirm("Reset EVERYTHING and load the demo bills?");
      if (!ok) return;
      bills = demoBills();
      saveBills();
      render();
    });

    // First render
    render();
  </script>
</body>
</html>
